webpackJsonp([1],{"1jDr":function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("7+uW"),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]},r=i("VU/8")({name:"app"},n,!1,function(t){i("eTbw")},null,null).exports,o=i("/ocq"),s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"hello"},[i("h1",[t._v(t._s(t.msg))]),t._v(" "),i("h2",[t._v("Essential Links")]),t._v(" "),t._m(0),t._v(" "),i("h2",[t._v("Ecosystem")]),t._v(" "),t._m(1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",[i("li",[i("a",{attrs:{href:"https://vuejs.org",target:"_blank"}},[t._v("Core Docs")])]),t._v(" "),i("li",[i("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank"}},[t._v("Forum")])]),t._v(" "),i("li",[i("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank"}},[t._v("Community Chat")])]),t._v(" "),i("li",[i("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank"}},[t._v("Twitter")])]),t._v(" "),i("br"),t._v(" "),i("li",[i("a",{attrs:{href:"http://vuejs-templates.github.io/webpack/",target:"_blank"}},[t._v("Docs for This Template")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("a",{attrs:{href:"http://router.vuejs.org/",target:"_blank"}},[this._v("vue-router")])]),this._v(" "),e("li",[e("a",{attrs:{href:"http://vuex.vuejs.org/",target:"_blank"}},[this._v("vuex")])]),this._v(" "),e("li",[e("a",{attrs:{href:"http://vue-loader.vuejs.org/",target:"_blank"}},[this._v("vue-loader")])]),this._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank"}},[this._v("awesome-vue")])])])}]},l=i("VU/8")({name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App"}}},s,!1,function(t){i("pVZD")},"data-v-d14401cc",null).exports,c=i("Dd8w"),d=i.n(c),u=i("fZjL"),h=i.n(u),v={Folder:AV.Object.extend("Folder"),Artical:AV.Object.extend("Artical"),updateFolder:function(t){var e=void 0;return e=t.id?AV.Object.createWithoutData("Folder",t.id):new this.Folder,t.del?e.destroy():(e.set("name",t.name),e.save())},updateArtical:function(t){var e=void 0;return e=t.id?AV.Object.createWithoutData("Artical",t.id):new this.Artical,-1===t.status?e.destroy():(h()(t).forEach(function(i){"id"!==i&&e.set(i,t[i])}),e.save())},getList:function(t,e){var i=new AV.Query(t);return e&&h()(e).forEach(function(t){i.equalTo(t,e[t])}),i.descending("createdAt"),i.find()}},p={name:"editor",data:function(){return{articalTitle:"",frameUrl:8080===location.port?"//localhost:8080/dist/my-editor/index.html":"./my-editor/index.html",editorInstance:!1,showLeftMenu:[],path:[],isAddFolder:!1,isEditFolder:!1,newFolderName:"新建目录",savePath:null,saveArtical:null}},created:function(){var t=this;window.editorLoadCallback||(window.editorLoadCallback=function(e){console.log("editor load callback"),t.editorInstance=e})},mounted:function(){var t=this;v.getList("Folder").then(function(e){t.path=t.getAttribute(e)})},methods:{getAttribute:function(t){return t.map(function(t){return d()({},t.attributes,{id:t.id})})},publish:function(t){var e=this;if(this.editorInstance){var i={status:t,artical_title:this.articalTitle,artical_thumb:"",artical_content:this.editorInstance.getHTML(),artical_markdown:this.editorInstance.getMarkdown(),artical_folder:d()({},this.savePath,{artical:[]})};this.saveArtical&&(i.id=this.saveArtical.id),v.updateArtical(i).then(function(t){if(t.id){alert((i.id?"编辑":"新增")+"成功");var a=d()({id:t.id},i);if(i.id){var n=e.savePath.artical.findIndex(function(t){return t.id===i.id});e.$set(e.savePath.artical,n,a)}else if(e.savePath.artical)e.savePath.artical.unshift(a);else{e.$set(e.savePath,"artical",[a]);var r=e.path.findIndex(function(t){return t.id===e.savePath.id});e.toggle(r,e.savePath)}}})}else alert("editor未初始化")},setArticalFill:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.editorInstance?(console.log("editor instance is exist"),this.$refs.frame.contentWindow.Editor.setValue(e.artical_markdown||"")):(console.log("editor has no instance"),localStorage.setItem("editFillContent",e.artical_markdown||"")),this.savePath=t,this.saveArtical=e,this.articalTitle=e.artical_title||""},toggle:function(t,e){var i=this;this.showLeftMenu[t]||e.artical||v.getList("Artical",{"artical_folder.id":e.id}).then(function(t){i.$set(e,"artical",i.getAttribute(t))}),this.$set(this.showLeftMenu,t,!this.showLeftMenu[t])},selectPath:function(t){this.isEditFolder?console.log("请先编辑完成"):(this.setArticalFill(t),this.saveArtical=null)},confirmAddFolder:function(){var t=this;if(this.newFolderName){var e={name:this.newFolderName};this.isEditFolder&&(e.id=this.savePath.id),v.updateFolder(e).then(function(i){console.log(i.id),i.id&&(t.isEditFolder?t.savePath.name=e.name:t.path.unshift(d()({},e,{id:i.id})),t.cancelAddFolder(),alert("操作成功"))})}else alert("请输入目录名称")},cancelAddFolder:function(){this.isAddFolder=!1,this.isEditFolder=!1,this.newFolderName="新建目录"},addFolder:function(){this.isEditFolder?alert("请先编辑完成"):this.isAddFolder=!0},editCurrFolder:function(){this.isAddFolder?alert("请先新建完成"):(this.isEditFolder=!0,this.newFolderName=this.savePath.name)},delFolder:function(){var t=this,e=this.path.findIndex(function(e){return e.id===t.savePath.id});void 0!==this.showLeftMenu[e]?this.savePath.artical&&this.savePath.artical.length>0?alert("请先删除该目录下的文章"):v.updateFolder(d()({},this.savePath,{del:!0})).then(function(i){i.id&&(t.path.splice(e,1),t.showLeftMenu[e]=!1)}):alert("请先查看该目录下是否存在文章")},delArtical:function(t,e){var i=this;v.updateArtical(d()({},t,{status:-1})).then(function(a){if(a.id){var n=i.path[e].artical.findIndex(function(e){return e.id===t.id});i.path[e].artical.splice(n,1),i.$set(i.path,e,i.path[e]),alert("删除成功")}})}}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrap"},[i("div",{staticClass:"left-menu position-a left-0 top-0 bottom-0 bd-ccc-r"},[i("ul",{staticClass:"menu-top"},[i("li",{staticClass:"px-font-16 px-line-50 px-height-50 bd-ccc-b hover-bg text-center color-folder",on:{click:function(e){e.stopPropagation(),t.addFolder(e)}}},[i("i",{staticClass:"iconfont icon-add"}),t._v(" "),i("span",[t._v("新建目录")])]),t._v(" "),i("li",{directives:[{name:"show",rawName:"v-show",value:t.isAddFolder,expression:"isAddFolder"}],class:"px-font-14 px-padding-10"},[i("i",{staticClass:"iconfont icon-queding fr color-c999 px-margin-t5",on:{click:function(e){e.stopPropagation(),t.confirmAddFolder(e)}}}),t._v(" "),i("i",{staticClass:"iconfont icon-guanbi fr color-c999 px-margin-5",on:{click:function(e){e.stopPropagation(),t.cancelAddFolder(e)}}}),t._v(" "),i("i",{staticClass:"iconfont icon-CombinedShape1 color-folder"}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.newFolderName,expression:"newFolderName",modifiers:{trim:!0}}],staticClass:"new-folder-input",attrs:{type:"text",maxlength:"10"},domProps:{value:t.newFolderName},on:{input:function(e){e.target.composing||(t.newFolderName=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),t._l(t.path,function(e,a){return[i("li",{key:e.id,class:"px-font-16 px-padding-10 "+(t.savePath&&t.savePath.id===e.id?"bg-f2":""),on:{click:function(i){i.stopPropagation(),t.selectPath(e)}}},[t.isEditFolder&&t.savePath.id===e.id?[i("i",{staticClass:"iconfont icon-queding fr color-c999 px-margin-t5",on:{click:function(e){e.stopPropagation(),t.confirmAddFolder(e)}}}),t._v(" "),i("i",{staticClass:"iconfont icon-guanbi fr color-c999 px-margin-5",on:{click:function(e){e.stopPropagation(),t.cancelAddFolder(e)}}})]:i("i",{class:"iconfont px-font-10 px-margin-t5 color-ccc fr "+(t.showLeftMenu[a]?"icon-jiantou":"icon-Triangle"),on:{click:function(i){i.stopPropagation(),t.toggle(a,e)}}}),t._v(" "),i("i",{staticClass:"iconfont icon-CombinedShape1 color-folder"}),t._v(" "),t.isEditFolder&&t.savePath.id===e.id?i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.newFolderName,expression:"newFolderName",modifiers:{trim:!0}}],staticClass:"new-folder-input px-font-14",attrs:{type:"text",maxlength:"20"},domProps:{value:t.newFolderName},on:{input:function(e){e.target.composing||(t.newFolderName=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}}):i("span",[t._v(t._s(e.name))])],2),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.showLeftMenu[a],expression:"showLeftMenu[index]"}]},[e.artical?[t._l(e.artical,function(n){return i("li",{key:n.id,staticClass:"hover-bg",on:{click:function(i){i.stopPropagation(),t.setArticalFill(e,n)}}},[i("i",{class:"iconfont icon-zhinan "+(0===n.status?"color-file":"color-green")}),t._v(" "),i("i",{staticClass:"fr iconfont icon-yishanchu color-c999",on:{click:function(e){e.stopPropagation(),t.delArtical(n,a)}}}),t._v(" "),i("span",[t._v(t._s(n.artical_title))])])}),t._v(" "),0===e.artical.length?i("li",{staticClass:"hover-bg"},[t._v("还没有文章")]):t._e()]:t._e()],2)]})],2)]),t._v(" "),i("div",{staticClass:"right-content position-a right-0 top-0 bottom-0"},[i("div",{staticClass:"title bd-ccc-b cl px-font-14 px-height-50"},[t.savePath?[i("div",{staticClass:"fr px-line-50 text-center px-margin-r10"},[i("div",{staticClass:"btn px-btn btn-error line-normal cursor-p",on:{click:function(e){t.publish(1)}}},[t._v("发布")])]),t._v(" "),i("div",{staticClass:"fr px-line-50 text-center px-margin-r10",on:{click:function(e){t.publish(0)}}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.saveArtical||1!==t.saveArtical.status,expression:"saveArtical ? saveArtical.status !== 1 : true "}],staticClass:"btn px-btn btn-aaa line-normal btn-inverse cursor-p"},[t._v("保存到草稿")])]),t._v(" "),i("div",{staticClass:"fr px-line-50 text-right w200 over-text px-margin-r10"},[i("span",[t._v(t._s(t.savePath.name))]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEditFolder,expression:"!isEditFolder"}]},[i("span",[t._v("/")]),t._v(" "),i("span",{staticClass:"color-info cursor-p",on:{click:t.editCurrFolder}},[t._v("编辑")]),t._v(" "),i("span",[t._v("/")]),t._v(" "),i("span",{staticClass:"color-error cursor-p",on:{click:t.delFolder}},[t._v("删除")])])])]:t._e(),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.articalTitle,expression:"articalTitle",modifiers:{trim:!0}}],staticClass:"height-100 px-padding-lr10 px-font-16",attrs:{type:"text",placeholder:t.savePath?"请输入标题":"从选择一个目录开始..."},domProps:{value:t.articalTitle},on:{input:function(e){e.target.composing||(t.articalTitle=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})],2),t._v(" "),i("div",{staticClass:"position-a px-top-60 px-bottom-10 width-100"},[t.savePath?i("iframe",{ref:"frame",attrs:{src:t.frameUrl,frameborder:"0",height:"100%",width:"100%"}}):i("div",{staticClass:"text-center px-padding-t100"},[i("p",{staticClass:"px-font-32 px-padding-t100"},[t._v("Hey, boy !")]),t._v(" "),i("span",{staticClass:"color-c666"},[t._v("世界在你手上...")])])])])])},staticRenderFns:[]},m=i("VU/8")(p,f,!1,function(t){i("1jDr")},null,null).exports;a.a.use(o.a);var _=new o.a({routes:[{path:"/",name:"HelloWorld",component:l},{path:"/editor",name:"Editor",component:m}]});a.a.config.productionTip=!1;AV.init({appId:"UjPTkcNRB9HL7458RuG6f8xk-gzGzoHsz",appKey:"ylcamdRnbp8FyA7CoDAL5BSz"}),new a.a({el:"#app",router:_,template:"<App/>",components:{App:r}})},eTbw:function(t,e){},pVZD:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.f753fa96b22eb377e9e4.js.map